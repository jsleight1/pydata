---
title: "Exploratory data analysis using pydata"
format: 
    gfm:
        preview-mode: raw
---

## `pydata`

`pydata` is a python package developed for the analysis and visualisation of 
L-shaped datasets. It can either be installed locally using `poetry` or an 
docker container environment has also be created which can be used for 
development and running the following examples.

`docker run -it docker.io/jsleight1/pydata:3.10-latest`

## Pydata generation and handling

```{python}
import matplotlib.pyplot as plt
from pydata.pydata import pydata

x=pydata.example_pydata()

print(x)
print(x.data.head(2))
print(x.description.head(2))
print(x.annotation.head(2))

s=x.subset(
    samples=["Sample1", "Sample30", "Sample52"], 
    features=["sepal_length", "petal_length"]
)
print(s)

t=x.transpose()
print(t)

```

## Linear dimensionality reduction

### PCA
```{python}

x.perform_pca()

print(x.pcs)

print(x.pcs.data)
print(x.pcs.description.head(2))
print(x.pcs.annotation)
```

### LDA
```{python}

x.perform_lda(target="Species", n_comp=2)

print(x.lda)

print(x.lda.data)
```


## Plotting

```{python}
x.plot(type="pca", colour_by="Species")
plt.show()
```

```{python}
x.plot(type="lda")
plt.show()
```

```{python}
x.transpose().plot(type="violin", fill=False)
plt.show()
```

```{python}
x.plot(
    type="feature_heatmap", 
    annotate_samples_by=["Species"], 
    annotate_features_by=["type"], 
    xticklabels=False
)
plt.show()
```

```{python}
x.plot(
    type="correlation_heatmap", 
    annotate_samples_by=["Species"], 
    xticklabels=False,
    yticklabels=False
)
plt.show()
```

```{python}
x.plot(type="distribution", kind="kde", legend=False)
x.transpose().subset(["sepal_length"]).plot(type="distribution", kde=True)
x.transpose().plot(type="distribution", kind="ecdf")
plt.show()
```

```{python}
x.transpose().plot(type="scatter")
plt.show()
```